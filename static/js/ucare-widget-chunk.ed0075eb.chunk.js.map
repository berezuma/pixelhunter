{"version":3,"sources":["../node_modules/@uploadcare/react-widget/dist/esm/uploader-a104e292.js"],"names":["useEventCallback","callback","ref","value","useRef","useEffect","current","useCommitedRef","useCallback","apply","arguments","useWidget","_ref3","uploadcare","id","name","onFileSelect","onChange","onDialogOpen","onDialogClose","onTabChange","apiRef","customTabs","validators","tabsCss","locale","localeTranslations","localePluralize","options","_objectWithoutProperties","input","widget","fileSelectedCallback","changeCallback","dialogOpenCallback","dialogCloseCallback","tabChangeCallback","useCustomTabs","attributes","factory","deps","isValid","valueRef","isEqual","result","cache","useDeepMemo","props","Object","entries","reduce","attr","_ref","_ref2","_slicedToArray","key","_objectSpread2","_defineProperty","concat","replace","toLowerCase","useDeepEffect","window","UPLOADCARE_LOCALE","UPLOADCARE_LOCALE_PLURALIZE","UPLOADCARE_LOCALE_TRANSLATIONS","plugin","internal","rebuild","Widget","widgetElement","nextSibling","parentNode","removeChild","instance","forEach","validator","push","length","useValidators","onUploadComplete","add","remove","dialog","saveDialog","done","fail","progress","reject","files","saveFiles","file","cancel","indexOf","addUrl","addStyle","useImperativeHandle","openDialog","reloadInfo","getInput","inputElement","React","createElement","_extends","type","Uploader","Input"],"mappings":"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","file":"static/js/ucare-widget-chunk.ed0075eb.chunk.js","sourcesContent":["import { _ as _extends, a as _objectWithoutProperties, b as _slicedToArray, c as _objectSpread2, d as _defineProperty } from './index-c16682ef.js';\nimport React, { useRef, useEffect, useCallback, useImperativeHandle } from 'react';\nimport uploadcare from 'uploadcare-widget';\nimport { u as useCustomTabs, a as useDeepEffect } from './use-deep-effect-514ff322.js';\nimport isEqual from 'react-fast-compare';\nimport '@uploadcare/client-suspense';\n\nvar useCommitedRef = function useCommitedRef(value) {\n  var ref = useRef(value);\n  useEffect(function () {\n    ref.current = value;\n  }, [value]);\n  return ref;\n};\n\nvar useEventCallback = function useEventCallback(callback) {\n  var ref = useCommitedRef(callback);\n  return useCallback(function () {\n    return ref.current && ref.current.apply(ref, arguments);\n  }, [ref]);\n};\n\nvar useValidators = function useValidators(widget, validators) {\n  useEffect(function () {\n    if (validators != null) {\n      var instance = widget.current;\n      validators.forEach(function (validator) {\n        instance.validators.push(validator);\n      });\n      return function () {\n        instance.validators.length = 0;\n      };\n    }\n  }, [widget, validators]);\n};\n\nfunction useDeepMemo(factory, deps) {\n  var isValid = true;\n  var valueRef = useRef(); // initial hook call\n\n  if (!valueRef.current) {\n    valueRef.current = {\n      deps: deps,\n      result: factory()\n    }; // subsequent calls\n  } else {\n    isValid = !!(deps && valueRef.current.deps && isEqual(deps, valueRef.current.deps));\n  }\n\n  var cache = isValid ? valueRef.current : {\n    deps: deps,\n    result: factory()\n  }; // must update immediately so any sync renders here don't cause an infinite loop\n\n  valueRef.current = cache;\n  return cache.result;\n}\n\nfunction camelCaseToDash(str) {\n  return str.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase();\n}\n\nvar propsToAttr = function propsToAttr(props) {\n  return Object.entries(props).reduce(function (attr, _ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        value = _ref2[1];\n\n    return _objectSpread2(_objectSpread2({}, attr), {}, _defineProperty({}, \"data-\".concat(camelCaseToDash(key)), value));\n  }, {});\n};\n\nvar useWidget = function useWidget(_ref3, uploadcare) {\n  var id = _ref3.id,\n      name = _ref3.name,\n      value = _ref3.value,\n      onFileSelect = _ref3.onFileSelect,\n      onChange = _ref3.onChange,\n      onDialogOpen = _ref3.onDialogOpen,\n      onDialogClose = _ref3.onDialogClose,\n      onTabChange = _ref3.onTabChange,\n      apiRef = _ref3.apiRef,\n      customTabs = _ref3.customTabs,\n      validators = _ref3.validators,\n      tabsCss = _ref3.tabsCss,\n      locale = _ref3.locale,\n      localeTranslations = _ref3.localeTranslations,\n      localePluralize = _ref3.localePluralize,\n      options = _objectWithoutProperties(_ref3, [\"id\", \"name\", \"value\", \"onFileSelect\", \"onChange\", \"onDialogOpen\", \"onDialogClose\", \"onTabChange\", \"apiRef\", \"customTabs\", \"validators\", \"tabsCss\", \"locale\", \"localeTranslations\", \"localePluralize\"]);\n\n  var input = useRef(null);\n  var widget = useRef(null);\n  var fileSelectedCallback = useEventCallback(onFileSelect);\n  var changeCallback = useEventCallback(onChange);\n  var dialogOpenCallback = useEventCallback(onDialogOpen);\n  var dialogCloseCallback = useEventCallback(onDialogClose);\n  var tabChangeCallback = useEventCallback(onTabChange);\n  useCustomTabs(customTabs, uploadcare);\n  var attributes = useDeepMemo(function () {\n    return propsToAttr(options);\n  }, [options]);\n  useDeepEffect(function () {\n    if (locale) window.UPLOADCARE_LOCALE = locale;\n    if (localePluralize) window.UPLOADCARE_LOCALE_PLURALIZE = localePluralize;\n\n    if (localeTranslations) {\n      window.UPLOADCARE_LOCALE_TRANSLATIONS = localeTranslations;\n    }\n\n    uploadcare.plugin(function (internal) {\n      internal.locale.rebuild({\n        locale: locale || null,\n        localeTranslations: localeTranslations || null,\n        localePluralize: localePluralize || null\n      });\n    });\n    return function () {\n      if (locale) delete window.UPLOADCARE_LOCALE;\n      if (localePluralize) delete window.UPLOADCARE_LOCALE_PLURALIZE;\n      if (localeTranslations) delete window.UPLOADCARE_LOCALE_TRANSLATIONS;\n    };\n  }, [locale, localeTranslations, localePluralize]);\n  useEffect(function () {\n    widget.current = uploadcare.Widget(input.current);\n    var widgetElement = input.current.nextSibling;\n    return function () {\n      return widgetElement && widgetElement.parentNode.removeChild(widgetElement);\n    };\n  }, [uploadcare, attributes]);\n  useValidators(widget, validators);\n  useEffect(function () {\n    widget.current.onUploadComplete.add(changeCallback);\n    widget.current.onChange.add(fileSelectedCallback);\n    return function () {\n      widget.current.onUploadComplete.remove(changeCallback);\n      widget.current.onChange.remove(fileSelectedCallback);\n    };\n  }, [changeCallback, fileSelectedCallback]);\n  useEffect(function () {\n    var dialog;\n\n    var saveDialog = function saveDialog(ref) {\n      dialog = ref;\n      dialog.done(dialogCloseCallback).fail(dialogCloseCallback).progress(tabChangeCallback);\n      dialogOpenCallback(ref);\n    };\n\n    widget.current.onDialogOpen.add(saveDialog);\n    return function () {\n      widget.current.onDialogOpen.remove(saveDialog);\n      dialog && dialog.reject();\n    };\n  }, [attributes, dialogCloseCallback, dialogOpenCallback, tabChangeCallback]);\n  useEffect(function () {\n    var files = [];\n\n    var saveFiles = function saveFiles(file) {\n      if (file) {\n        files = file.files ? file.files() : [file];\n      } else {\n        files = [];\n      }\n    };\n\n    widget.current.onChange.add(saveFiles);\n    return function () {\n      files.forEach(function (file) {\n        return file.cancel();\n      });\n      widget.current.onChange.remove(saveFiles);\n    };\n  }, [attributes]);\n  useEffect(function () {\n    widget.current.value(value);\n  }, [value]);\n  useEffect(function () {\n    if (uploadcare && tabsCss && typeof tabsCss === 'string') {\n      if (tabsCss.indexOf('https://') === 0) {\n        uploadcare.tabsCss.addUrl(tabsCss);\n      } else {\n        uploadcare.tabsCss.addStyle(tabsCss);\n      }\n    }\n  }, [uploadcare, tabsCss]);\n  useImperativeHandle(apiRef, function () {\n    return {\n      openDialog: function openDialog() {\n        return widget.current.openDialog();\n      },\n      reloadInfo: function reloadInfo() {\n        return widget.current.reloadInfo();\n      },\n      getInput: function getInput() {\n        return widget.current.inputElement;\n      }\n    };\n  }, []);\n  return useCallback(function () {\n    return /*#__PURE__*/React.createElement(\"input\", _extends({\n      type: \"hidden\",\n      ref: input,\n      id: id,\n      name: name\n    }, attributes));\n  }, [attributes, id, name]);\n};\n\nvar Uploader = function Uploader(props) {\n  var Input = useWidget(props, uploadcare);\n  return /*#__PURE__*/React.createElement(Input, null);\n};\n\nexport default Uploader;\n"],"sourceRoot":""}